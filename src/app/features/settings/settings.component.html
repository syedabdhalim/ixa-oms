<div class="p-4">
  <div class="flex align-items-center gap-2">
    <i class="pi pi-cog text-2xl"></i>
    <h2 class="m-0">Settings</h2>
  </div>
  <div class="text-700 mt-1">System configuration</div>

  <!-- Company Profile -->
  <div class="surface-card p-3 border-1 surface-border border-round mt-3">
    <h3 class="m-0 mb-3">Company Profile</h3>

    <div class="formgrid grid">
      <div class="field col-12 md:col-6 lg:col-6">
        <label class="text-700 block mb-2" for="companyName">Company Name</label>
        <input id="companyName" type="text"
               [ngModel]="draft().companyName"
               (ngModelChange)="updateDraft({ companyName: $event })"
               class="w-full p-2 border-1 surface-border border-round">
      </div>

      <div class="field col-12 md:col-6 lg:col-6">
        <label class="text-700 block mb-2" for="regNo">Registration No</label>
        <input id="regNo" type="text"
               [ngModel]="draft().companyRegistrationNo"
               (ngModelChange)="updateDraft({ companyRegistrationNo: $event })"
               class="w-full p-2 border-1 surface-border border-round">
      </div>

      <div class="field col-12 md:col-6 lg:col-6">
        <label class="text-700 block mb-2" for="phone">Phone</label>
        <input id="phone" type="text"
               [ngModel]="draft().companyPhone"
               (ngModelChange)="updateDraft({ companyPhone: $event })"
               class="w-full p-2 border-1 surface-border border-round">
      </div>

      <div class="field col-12 md:col-6 lg:col-6">
        <label class="text-700 block mb-2" for="email">Email</label>
        <input id="email" type="email"
               [ngModel]="draft().companyEmail"
               (ngModelChange)="updateDraft({ companyEmail: $event })"
               class="w-full p-2 border-1 surface-border border-round">
      </div>

      <div class="field col-12 md:col-6 lg:col-6">
        <label class="text-700 block mb-2" for="website">Website</label>
        <input id="website" type="text"
               [ngModel]="draft().companyWebsite"
               (ngModelChange)="updateDraft({ companyWebsite: $event })"
               class="w-full p-2 border-1 surface-border border-round">
      </div>

      <div class="field col-12 md:col-6 lg:col-6">
        <label class="text-700 block mb-2" for="logo">Logo URL</label>
        <input id="logo" type="text"
               [ngModel]="draft().companyLogoUrl"
               (ngModelChange)="updateDraft({ companyLogoUrl: $event })"
               placeholder="https://..."
               class="w-full p-2 border-1 surface-border border-round">
      </div>
    </div>

    <div class="mt-3">
      <label class="text-700 block mb-2" for="address">Address</label>
      <textarea id="address" rows="3"
                [ngModel]="draft().companyAddress"
                (ngModelChange)="updateDraft({ companyAddress: $event })"
                class="w-full p-2 border-1 surface-border border-round"></textarea>
    </div>
  </div>

  <!-- Currency & Date Format -->
  <div class="surface-card p-3 border-1 surface-border border-round mt-3">
    <h3 class="m-0 mb-3">Currency & Date</h3>
    <div class="formgrid grid">
      <div class="field col-12 md:col-4">
        <label class="text-700 block mb-2" for="currency">Currency</label>
        <select id="currency" class="w-full p-2 border-1 surface-border border-round"
                [ngModel]="draft().currencyCode"
                (ngModelChange)="updateDraft({ currencyCode: $event })">
          <option *ngFor="let c of currencyOptions" [ngValue]="c.value">{{ c.label }}</option>
        </select>
      </div>
      <div class="field col-12 md:col-4">
        <label class="text-700 block mb-2" for="locale">Locale</label>
        <select id="locale" class="w-full p-2 border-1 surface-border border-round"
                [ngModel]="draft().locale"
                (ngModelChange)="updateDraft({ locale: $event })">
          <option *ngFor="let l of localeOptions" [ngValue]="l.value">{{ l.label }}</option>
        </select>
      </div>
      <div class="field col-12 md:col-4">
        <label class="text-700 block mb-2" for="dateFmt">Date Format</label>
        <select id="dateFmt" class="w-full p-2 border-1 surface-border border-round"
                [ngModel]="draft().dateFormat"
                (ngModelChange)="updateDraft({ dateFormat: $event })">
          <option *ngFor="let d of dateFormatOptions" [ngValue]="d.value">{{ d.label }}</option>
        </select>
      </div>
    </div>
  </div>

  <!-- Document Numbering -->
  <div class="surface-card p-3 border-1 surface-border border-round mt-3">
    <h3 class="m-0 mb-3">Document Numbering</h3>
    <div class="formgrid grid">
      <div class="field col-12 md:col-6 lg:col-3">
        <label class="text-700 block mb-2" for="orderPrefix">Order Prefix</label>
        <input id="orderPrefix" type="text"
               [ngModel]="draft().orderPrefix"
               (ngModelChange)="updateDraft({ orderPrefix: $event })"
               class="w-full p-2 border-1 surface-border border-round">
      </div>
      <div class="field col-12 md:col-6 lg:col-3">
        <label class="text-700 block mb-2" for="orderNext">Next Order Number</label>
        <input id="orderNext" type="number" min="1" step="1"
               [ngModel]="draft().orderNextNumber"
               (ngModelChange)="updateDraft({ orderNextNumber: toNumber($event, 1) })"
               class="w-full p-2 border-1 surface-border border-round">
      </div>
      <div class="field col-12 md:col-6 lg:col-3">
        <label class="text-700 block mb-2" for="invoicePrefix">Invoice Prefix</label>
        <input id="invoicePrefix" type="text"
               [ngModel]="draft().invoicePrefix"
               (ngModelChange)="updateDraft({ invoicePrefix: $event })"
               class="w-full p-2 border-1 surface-border border-round">
      </div>
      <div class="field col-12 md:col-6 lg:col-3">
        <label class="text-700 block mb-2" for="invoiceNext">Next Invoice Number</label>
        <input id="invoiceNext" type="number" min="1" step="1"
               [ngModel]="draft().invoiceNextNumber"
               (ngModelChange)="updateDraft({ invoiceNextNumber: toNumber($event, 1) })"
               class="w-full p-2 border-1 surface-border border-round">
      </div>
      <div class="field col-12 md:col-6 lg:col-3 flex align-items-center gap-2 mt-1">
        <input type="checkbox" id="resetAnnually"
               [ngModel]="draft().resetNumbersAnnually"
               (ngModelChange)="updateDraft({ resetNumbersAnnually: $event })">
        <label for="resetAnnually">Reset numbering annually</label>
      </div>
    </div>
  </div>

  <!-- Invoicing Text -->
  <div class="surface-card p-3 border-1 surface-border border-round mt-3">
    <h3 class="m-0 mb-3">Invoicing Text</h3>
    <div class="formgrid grid">
      <div class="field col-12">
        <label class="text-700 block mb-2" for="invNotes">Invoice Notes</label>
        <textarea id="invNotes" rows="3"
                  [ngModel]="draft().invoiceNotes"
                  (ngModelChange)="updateDraft({ invoiceNotes: $event })"
                  class="w-full p-2 border-1 surface-border border-round"></textarea>
      </div>
      <div class="field col-12">
        <label class="text-700 block mb-2" for="invFooter">Invoice Footer</label>
        <textarea id="invFooter" rows="2"
                  [ngModel]="draft().invoiceFooter"
                  (ngModelChange)="updateDraft({ invoiceFooter: $event })"
                  class="w-full p-2 border-1 surface-border border-round"></textarea>
      </div>
      <div class="field col-12 flex align-items-center gap-2 mt-1">
        <input type="checkbox" id="showLogo"
               [ngModel]="draft().showCompanyLogoOnDocs"
               (ngModelChange)="updateDraft({ showCompanyLogoOnDocs: $event })">
        <label for="showLogo">Show company logo on documents</label>
      </div>
    </div>
  </div>

  <div class="surface-card p-3 border-1 surface-border border-round mt-3">
    <h3 class="m-0 mb-3">Order Approval</h3>

    <div class="flex align-items-center gap-2 mb-2">
      <input type="checkbox"
             [ngModel]="draft().requireApproval"
             (ngModelChange)="updateDraft({ requireApproval: $event })"
             id="requireApproval">
      <label for="requireApproval">Require approvals for certain orders</label>
    </div>

    <div class="formgrid grid">
      <div class="field col-12 md:col-6 lg:col-4">
        <label for="maxAmount" class="text-700 block mb-2">Max auto-approve amount (MYR)</label>
        <input id="maxAmount" type="number" min="0" step="100"
               [ngModel]="draft().maxAutoApproveAmount"
               (ngModelChange)="updateDraft({ maxAutoApproveAmount: toNumber($event, 0) })"
               class="w-full p-2 border-1 surface-border border-round">
      </div>

      <div class="field col-12 md:col-6 lg:col-4">
        <label for="maxDiscount" class="text-700 block mb-2">Max discount percent (%)</label>
        <input id="maxDiscount" type="number" min="0" max="100" step="1"
               [ngModel]="draft().maxDiscountPercent"
               (ngModelChange)="updateDraft({ maxDiscountPercent: clamp(toNumber($event, 0), 0, 100) })"
               class="w-full p-2 border-1 surface-border border-round">
      </div>

      <div class="field col-12 md:col-6 lg:col-4 flex align-items-center gap-2 mt-1">
        <input type="checkbox"
               [ngModel]="draft().allowPriceOverride"
               (ngModelChange)="updateDraft({ allowPriceOverride: $event })"
               id="allowOverride">
        <label for="allowOverride">Allow price override without approval</label>
      </div>
    </div>

    <div class="mt-3 flex justify-content-end gap-2">
      <button type="button" (click)="reset()" class="flex align-items-center gap-2 p-2 px-3 border-1 surface-border border-round">
        <i class="pi pi-refresh"></i>
        <span>Reset to defaults</span>
      </button>
      <button type="button" (click)="save()" class="flex align-items-center gap-2 p-2 px-3 border-1 border-round" style="background: var(--p-primary-color); border-color: var(--p-primary-color); color: white">
        <i class="pi pi-save"></i>
        <span>Save changes</span>
      </button>
    </div>
  </div>
</div>


